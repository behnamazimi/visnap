---
title: Storybook Adapter
description: Test your Storybook stories with ViSnap
---

The Storybook adapter lets you test individual stories from your Storybook build. It's the most common way to use ViSnap.

## Setup

Add the Storybook adapter to your configuration:

```typescript
testCase: [{
  name: "@visnap/storybook-adapter",
  options: {
    source: "./storybook-static", // path to Storybook build
    port: 4477,                   // port for local static server
    include: "*",                 // which stories to test
    exclude: "*-skip*"            // which stories to skip
  }
}]
```

## Source Options

### Local Build Directory

Point to your built Storybook:

```typescript
source: "./storybook-static"
```

### Remote Storybook

Test a live Storybook instance:

```typescript
source: "https://storybook.example.com"
```

## Filtering Stories

Use minimatch patterns to control which stories are tested:

```typescript
// Test all stories
include: "*"

// Test only button stories
include: "button-*"

// Test multiple patterns
include: ["button-*", "input-*"]

// Skip specific stories
exclude: "*-skip*"

// Skip multiple patterns
exclude: ["*-skip*", "*admin*"]
```

## Custom Screenshot Targets

Target a specific element in the story for the screenshot:

```typescript
export const ComponentOnly: Story = {
  parameters: {
    visualTesting: {
      screenshotTarget: '.my-component'
    }
  }
};
```

## Story Configuration

Configure visual testing options directly in your stories:

```typescript
export default {
  title: 'Button',
  component: Button,
  parameters: {
    visualTesting: {
      skip: false,                    // Skip this story
      screenshotTarget: '#storybook-root',     // Custom screenshot target
      threshold: 0.05,               // Custom threshold for this story
      browser: ['chromium', 'firefox'], // Specific browsers
      viewport: { width: 1200, height: 800 }, // Custom viewport
      disableCSSInjection: true,     // Disable global CSS injection
      interactions: [                // Execute interactions before screenshot
        { type: 'click', selector: 'button' },
        { type: 'fill', selector: 'input', text: 'test' }
      ]
    }
  }
};
```

## Story Parameters

### `skip`

Skip this story entirely:

```typescript
visualTesting: {
  skip: true
}
```

### `screenshotTarget`

Specify which element to screenshot:

```typescript
visualTesting: {
  screenshotTarget: '#storybook-root' // default
  // or
  screenshotTarget: '.my-component'
}
```

### `threshold`

Override the global threshold for this story:

```typescript
visualTesting: {
  threshold: 0.05 // 5% difference threshold
}
```

### `browser`

Test only specific browsers:

```typescript
visualTesting: {
  browser: ['chromium'] // only test in Chromium
  // or
  browser: ['chromium', 'firefox'] // test in both
}
```

### `viewport`

Use a custom viewport for this story:

```typescript
visualTesting: {
  viewport: { width: 1200, height: 800 }
}
```

### `disableCSSInjection`

Disable global CSS injection for this story:

```typescript
visualTesting: {
  disableCSSInjection: true
}
```

### `interactions`

Execute user interactions before taking the screenshot:

```typescript
visualTesting: {
  interactions: [
    { type: 'click', selector: 'button.primary' },
    { type: 'fill', selector: 'input[name="email"]', text: 'test@example.com' },
    { type: 'waitForTimeout', duration: 500 },
    { type: 'hover', selector: '.tooltip-trigger' }
  ]
}
```

### Mask elements

Overlay specific elements (without hiding them) to stabilize screenshots:

```typescript
export const WithStickyHeader: Story = {
  parameters: {
    visualTesting: {
      elementsToMask: ['.sticky', '#ad-slot']
    }
  }
};
```

Or, if youâ€™re using the [Playwright adapter](/docs/adapters/playwright), you can use the injectCSS option to hide or mask any elements you want with custom CSS.

## Common Use Cases

### Testing Form Interactions

```typescript
export const FilledForm: Story = {
  parameters: {
    visualTesting: {
      interactions: [
        { type: 'fill', selector: 'input[name="email"]', text: 'test@example.com' },
        { type: 'fill', selector: 'input[name="password"]', text: 'password123' },
        { type: 'click', selector: 'button[type="submit"]' },
        { type: 'waitForTimeout', duration: 1000 }
      ]
    }
  }
};
```

### Testing Hover States

```typescript
export const HoverState: Story = {
  parameters: {
    visualTesting: {
      interactions: [
        { type: 'hover', selector: '.button' }
      ]
    }
  }
};
```

### Testing Loading States

```typescript
export const LoadingState: Story = {
  parameters: {
    visualTesting: {
      interactions: [
        { type: 'click', selector: 'button.load-data' },
        { type: 'wait', selector: '.loading-spinner' },
        { type: 'waitForTimeout', duration: 2000 }
      ]
    }
  }
};
```

## Troubleshooting

### Story Not Found

Make sure your Storybook build is up to date:

```npm
npm run build-storybook
```

### Port Conflicts

If port 4477 is in use, change it in your config:

```typescript
options: {
  port: 4478 // use different port
}
```

### Stories Not Loading

Check that your `source` path is correct and contains the Storybook build files.
