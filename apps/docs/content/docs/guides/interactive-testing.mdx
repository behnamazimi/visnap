---
title: Interactive Testing
description: Execute user interactions before capturing screenshots
---

Use interactions to make components or pages reach a desired state before screenshots.

## Configuration

Interactions are defined at the test-case level, not as a single global list.

- When using the [Storybook adapter](/docs/adapters/storybook), you can define interactions at the story level via `parameters.visualTesting.interactions`.

```typescript
// Per-story example (with Storybook adapter)
export const FilledForm: Story = {
  parameters: {
    visualTesting: {
      interactions: [
        { type: 'fill', selector: 'input[name="email"]', text: 'test@example.com' },
        { type: 'press', selector: 'input[name="email"]', key: 'Enter' },
        { type: 'wait', selector: '.loaded' },
        { type: 'waitForTimeout', duration: 500 },
      ]
    }
  }
};
```

- For interactive testing for the URL adapter you have to define them in the adapter options in the `visnap.config`.

```typescript
// URL test example (with URL adapter)
// ...
{
  name: "@visnap/url-adapter",
  options: {
    urls: [
      {
        id: "homepage",
        url: "https://www.example.com/",
        interactions: [
          { type: "fill", selector: 'input[name="email"]', text: "test@example.com" },
          { type: "press", selector: 'input[name="email"]', key: "Enter" },
        ],
      },
    ],
  },
},
// ...
```

## Supported Actions (subset)

- click / dblclick
- type / fill / press
- hover / focus / blur
- select / check / uncheck / setChecked
- setInputFiles
- wait / waitForTimeout / waitForLoadState
- dragAndDrop / scrollIntoView

See the API Reference for the full protocol and options.

```typescript
// Config override example
export default {
  adapters: { /* ... */ },
  comparison: { core: 'odiff', threshold: 0.1 },
  viewport: { desktop: { width: 1920, height: 1080 } },
};
```

## Tips

- Prefer `wait` for DOM readiness over arbitrary `waitForTimeout` when possible.
- Disable animations using injected CSS for stable captures.

## How It Works

1. Load the target page/test case
2. Execute configured interactions
3. Wait for UI to stabilize
4. Capture the screenshot

## Basic Usage

Define interactions for a test case using the interaction protocol (tool‑agnostic):

```typescript
interactions: [
  { type: 'fill', selector: 'input[name="email"]', text: 'test@example.com' },
  { type: 'click', selector: 'button[type="submit"]' },
  { type: 'wait', selector: '.success-message' },
]
```

## Available Interactions

### Click Actions

**Basic click:**
```typescript
{ type: 'click', selector: 'button.primary' }
```

**Right-click:**
```typescript
{ type: 'click', selector: 'button', button: 'right' }
```

**Double-click:**
```typescript
{ type: 'dblclick', selector: 'button' }
```

### Input Actions

**Fill input field:**
```typescript
{ type: 'fill', selector: 'input[name="email"]', text: 'test@example.com' }
```

**Type slowly (simulates real typing):**
```typescript
{ type: 'type', selector: 'input[name="search"]', text: 'search query' }
```

**Clear input field:**
```typescript
{ type: 'clear', selector: 'input[name="email"]' }
```

### Mouse Actions

**Hover over element:**
```typescript
{ type: 'hover', selector: '.tooltip-trigger' }
```

**Drag and drop:**
```typescript
{ type: 'dragAndDrop', sourceSelector: '.draggable', targetSelector: '.drop-zone' }
```

### Keyboard Actions

**Press Enter:**
```typescript
{ type: 'press', selector: 'body', key: 'Enter' }
```

**Press Tab:**
```typescript
{ type: 'press', selector: 'body', key: 'Tab' }
```

**Press Escape:**
```typescript
{ type: 'press', selector: 'body', key: 'Escape' }
```

### Wait Actions

**Wait for specific duration:**
```typescript
{ type: 'waitForTimeout', duration: 1000 } // 1 second
```

**Wait for element to appear:**
```typescript
{ type: 'wait', selector: '.loaded' }
```

// Waiting for specific text can be implemented via adapter-specific helpers.

### Scroll Actions

**Scroll to specific position:**
```typescript
{ type: 'scrollIntoView', selector: '.scrollable' }
```

## Common Patterns

### Form Submission

Tool‑agnostic example:

```typescript
interactions: [
  { type: 'fill', selector: 'input[name="name"]', text: 'John Doe' },
  { type: 'fill', selector: 'input[name="email"]', text: 'john@example.com' },
  { type: 'click', selector: 'button[type="submit"]' },
  { type: 'wait', selector: '.success-message' },
]
```

### Modal/Dropdown Opening

```typescript
interactions: [
  { type: 'click', selector: 'button.open-modal' },
  { type: 'wait', selector: '.modal' },
]
```

### Hover States

```typescript
interactions: [ { type: 'hover', selector: '.button' } ]
```

### Loading States

```typescript
interactions: [
  { type: 'click', selector: 'button.load-data' },
  { type: 'wait', selector: '.loading-spinner' },
  { type: 'waitForTimeout', duration: 2000 },
]
```

### Multi-Step Flows

```typescript
interactions: [
  { type: 'click', selector: 'button.settings' },
  { type: 'wait', selector: '.settings-modal' },
  { type: 'click', selector: 'select.theme' },
  { type: 'click', selector: 'option[value="dark"]' },
  { type: 'click', selector: 'button.save' },
  { type: 'wait', selector: '.success-message' },
]
```

// URL adapter interactions are not yet supported (coming soon).

## Best Practices

### Wait for State Changes

Always wait for the UI to update after interactions:

```typescript
// Good: Wait for the result
{ type: 'click', selector: 'button.submit' },
{ type: 'wait', selector: '.result' }

// Bad: No wait
{ type: 'click', selector: 'button.submit' }
```

### Use Specific Selectors

Prefer specific selectors over generic ones:

```typescript
// Good: Specific selector
{ type: 'click', selector: 'button[type="submit"]' }

// Bad: Generic selector
{ type: 'click', selector: 'button' }
```

### Add Reasonable Delays

Use timeouts for animations and transitions:

```typescript
{ type: 'click', selector: 'button.animate' },
{ type: 'waitForTimeout', duration: 500 } // Wait for animation
```

### Test Edge Cases

Test different interaction scenarios:

```typescript
// Test empty form submission
{ type: 'click', selector: 'button[type="submit"]' }

// Test form with invalid data
{ type: 'fill', selector: 'input[name="email"]', text: 'invalid-email' },
{ type: 'click', selector: 'button[type="submit"]' }
```

## Troubleshooting

### Interactions Not Working

Check that selectors exist on the page:

```typescript
// Make sure the selector is correct
{ type: 'click', selector: 'button.primary' } // not 'button.primery'
```

### Timing Issues

Add appropriate waits:

```typescript
{ type: 'click', selector: 'button' },
{ type: 'waitForTimeout', duration: 1000 } // Wait for state change
```

### Element Not Found

Use more specific selectors or wait for elements to appear:

```typescript
{ type: 'wait', selector: '.dynamic-content' },
{ type: 'click', selector: '.dynamic-content button' }
```


## Next Steps
