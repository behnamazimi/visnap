---
title: Configs
description: Overview of ViSnap configuration and where to learn more
---

ViSnap uses a `visnap.config.ts` file in your project root. This file defines how tests run, which browsers to use, where to save screenshots, etc.

## Basic Structure

```typescript
import { type VisualTestingToolConfig } from '@visnap/protocol';

const config: VisualTestingToolConfig = {
  adapters: {
    browser: { /* browser configuration */ },
    testCase: [ /* test case adapters */ ]
  },
  screenshotDir: "visnap",
  // ... other options
};

export default config;
```

## Adapters

### Browser Adapter

This type of adapter controls which browser engine to use for taking screenshots.

For now, ViSnap provides a Playwright-based browser adapter. More browser adapters will be added to support different tools.

```typescript
adapters: {
  browser: {
    name: "@visnap/playwright-adapter",
    options: {
      launch: { browser: 'chromium', headless: true },
      context: { colorScheme: 'light', reducedMotion: 'reduce' },
      navigation: { baseUrl: 'http://localhost:3000', waitUntil: 'load', timeoutMs: 30000 },
      injectCSS: `* { animation: none !important; transition: none !important; }`
    }
  }
}
```

See the [Playwright Adapter](/docs/adapters/playwright) for detailed configuration.

### Test Case Adapters

Define where your test cases come from. Currently, ViSnap includes a [Storybook adapter](/docs/adapters/storybook) and a [URL adapter](/docs/adapters/url).

**Storybook Adapter:**
```typescript
testCase: [{
  name: "@visnap/storybook-adapter",
  options: {
    source: "./storybook-static", // or URL to remote Storybook
    port: 4477,
    include: "*", // minimatch pattern
    exclude: "*-skip*"
  }
}]
```
See the [Storybook Adapter](/docs/adapters/storybook) for detailed configuration.

**URL Adapter:**
```typescript
testCase: [{
  name: "@visnap/url-adapter",
  options: {
    urls: [
      { id: "homepage", url: "http://localhost:3000/", elementsToMask: ['.sticky'] },
      { id: "about", url: "http://localhost:3000/about" }
    ],
    include: "*",
    exclude: "*admin*"
  }
}]
```

See the [URL Adapter](/docs/adapters/url) for detailed configuration.

## Core Settings

### Threshold

How different pixels need to be to count as a change (0.0 to 1.0).

```typescript
threshold: 0.1 // 10% difference threshold
```

### Screenshot Directory

Where to save screenshots and reports.

```typescript
screenshotDir: "visnap" // default
```

### Viewports

Test across different screen sizes.

```typescript
viewport: {
  desktop: { width: 1920, height: 1080 },
  tablet: { width: 768, height: 1024 },
  mobile: { width: 375, height: 667 }
}
```

### Runtime Options

Control how tests execute. You can set a single numeric concurrency (applies to both capture and compare), or provide separate limits.

```typescript
runtime: {
  // single number (applies to capture and compare)
  maxConcurrency: 4,
  // Or separate concurrency limits
  // maxConcurrency: { capture: 4, compare: 4 },
  quiet: false
}
```

### Comparison Engine

Choose how images are compared.

```typescript
comparison: {
  core: "odiff", // or "pixelmatch"
  threshold: 0.1,
  diffColor: "#00ff00"
}
```

### Reporting

Generate test reports.

```typescript
reporter: {
  html: true,  // interactive HTML report
  json: true   // machine-readable JSON report
}
```

## Environment Variables

Override defaults without changing config:

```bash
VISNAP_SCREENSHOT_DIR=./screenshots
VISNAP_THRESHOLD=0.05
```

## Complete Example

Here's a full configuration that works with Storybook:

```typescript
import { type VisualTestingToolConfig } from '@visnap/protocol';

const config: VisualTestingToolConfig = {
  adapters: {
    browser: {
      name: "@visnap/playwright-adapter",
      options: {
        launch: { browser: 'chromium', headless: true },
        context: { colorScheme: 'light', reducedMotion: 'reduce' },
        injectCSS: `* { animation: none !important; transition: none !important; }`
      }
    },
    testCase: [{
      name: "@visnap/storybook-adapter",
      options: {
        source: "./storybook-static",
        port: 4477,
        include: "*",
        exclude: "*-skip*"
      }
    }]
  },
  screenshotDir: "visnap",
  viewport: {
    desktop: { width: 1920, height: 1080 },
    mobile: { width: 375, height: 667 }
  },
  runtime: {
    maxConcurrency: { capture: 4, compare:2 } // Or a number which will be applied to both
  },
  comparison: {
    core: "odiff",
    threshold: 0.1
  },
  reporter: {
    html: true,
    json: true
  }
};

export default config;
```

## Storage

ViSnap uses the filesystem to store screenshot files. Screenshots are organized in the following directory structure:

```
visnap/
├── base/     # Baseline screenshots (from visnap update)
├── current/  # Current screenshots (from visnap test)
└── diff/     # Diff images (generated during comparison)
```

The storage system is abstracted through the `@visnap/fs-adapter` package, which handles all file operations.
